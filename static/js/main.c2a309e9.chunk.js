(this.webpackJsonpui=this.webpackJsonpui||[]).push([[0],{217:function(t,e,i){},225:function(t,e,i){},226:function(t,e,i){},251:function(t,e,i){},257:function(t,e){},259:function(t,e){},269:function(t,e){},271:function(t,e){},298:function(t,e){},299:function(t,e){},304:function(t,e){},306:function(t,e){},313:function(t,e){},332:function(t,e){},348:function(t,e,i){},349:function(t,e,i){},350:function(t,e,i){},351:function(t,e,i){"use strict";i.r(e);i(217);var n,c=i(20),a=i.n(c),s=i(24),r=i(10),o=i(42),l=i(0),u=i.n(l),j=i(2),f=function t(){Object(o.a)(this,t),this.limits=[-4,-4,4,4],this.focusedArc=0,this.selectedArc=0,this.drawList=[]},d=function(t,e){var i=t,n=e;switch(console.log("DEBUG: signal "+JSON.stringify(e)),e.signalName){case"Ready":break;case"ArcFocus":console.debug("focus arc: ".concat(n.arc)),i.focusedArc=n.arc}return window._glamState=i,i},m=u.a.createContext(null),b=function(t){var e=Object(l.useReducer)(d,new f),i=Object(r.a)(e,2),n=i[0],c=i[1];return Object(j.jsx)(m.Provider,{value:[n,c],children:t.children})},h=i(11);!function(t){t[t.C=0]="C",t[t.R2C=1]="R2C",t[t.C2C=2]="C2C"}(n||(n={}));var O=function t(e,i){Object(o.a)(this,t),this.name=void 0,this.id=void 0,this.parameterName="",this.style={stroke:"white"},this.type=n.C,this.text="",this.stack=[],this.functionName="",this.jitFunction=void 0,this.drawing=!1,this.id=e,this.name=i},p=u.a.createContext(void 0),v=function(t){var e=Object(l.useReducer)((function(t,e){var i=Object(h.a)({},t);return i[e.pfId]=Object(h.a)(Object(h.a)({},t[e.pfId]?t[e.pfId]:new O(e.pfId,"New Function")),e.change),i}),{}),i=Object(r.a)(e,2),n=i[0],c=i[1];return Object(j.jsx)(p.Provider,{value:[n,c],children:t.children})};function x(t,e){var i=Object(l.useContext)(p);if(!i)throw"Protofunction context not provided!";var n=Object(r.a)(i,2),c=n[0],a=n[1];return c[t]||(a({pfId:t,change:{type:e}}),c[t]=new O(t,"New Function")),[c[t],function(e){return a({pfId:t,change:e})}]}var g,y=i(354),k=i(29),N=(i(223),i(224),i(225),i(1)),C=(i(226),function(t){var e=x(t.pfId),i=Object(r.a)(e,2),n=i[0],c=i[1],a=Object(l.useMemo)((function(){return n.jitFunction?n.jitFunction.getDisassembly():"module is not compiled!"}),[n.jitFunction]);return Object(j.jsx)(y.c,{className:"bp3-dark info-dialog",title:"".concat(n.id,": ").concat(n.name,"(").concat(n.parameterName,")"),isOpen:t.isOpen,onClose:t.closeCallback,children:Object(j.jsxs)(y.g,{id:"InfoTabs",className:N.a.DIALOG_BODY,vertical:!0,children:[Object(j.jsx)(y.f,{id:"options",title:"Options",panel:Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)(y.d,{children:["Opacity",Object(j.jsx)("p",{}),Object(j.jsx)(y.e,{min:0,max:1,stepSize:.005,vertical:!0,onChange:function(t){return c({style:Object(h.a)(Object(h.a)({},n.style),{},{opacity:t})})},value:parseFloat((n.style.opacity||1).toString())})]})})}),Object(j.jsx)(y.f,{id:"disassembly",title:"Disassembly",panel:Object(j.jsx)("div",{className:N.a.CODE_BLOCK,children:Object(j.jsx)("pre",{children:a})})})]})})}),w=i(106),E=Object(j.jsxs)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:[Object(j.jsx)("desc",{children:"new-point"}),Object(j.jsx)("circle",{cx:"50%",cy:"50%",r:6,fill:w.a.GREEN5})]}),I=Object(j.jsxs)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:[Object(j.jsx)("desc",{children:"new-arc"}),Object(j.jsx)("path",{d:"M0,8 Q4,0 8,8 12,16 16,8",stroke:w.a.GREEN5,fill:"none",strokeWidth:2})]}),M=i(162),F=(i(251),i(163)),R=i.n(F),S=MathQuill.getInterface(2);!function(t){t[t.NUMBER=0]="NUMBER",t[t.IDENTIFIER=1]="IDENTIFIER",t[t.OPERATOR=2]="OPERATOR",t[t.FXNCALL=3]="FXNCALL"}(g||(g={}));var T=function(){function t(){Object(o.a)(this,t),this.fxnName=void 0,this.fxnParam=void 0,this.symbol="",this.skipTo=-1,this.stack=[],this.tokens=[],this.parseErr=null}return Object(M.a)(t,[{key:"parseError",value:function(t){this.parseErr=t}},{key:"visitNumber",value:function(t){this.stack.push({type:g.NUMBER,value:t})}},{key:"visitIdentifier",value:function(t){t===this.fxnParam||Module.Globals.isGlobal(t)?this.stack.push({type:g.IDENTIFIER,value:t}):this.parseError("unrecognized symbol")}},{key:"visitBinary",value:function(t){this.stack.push({type:g.OPERATOR,value:t})}},{key:"visitUnary",value:function(t){this.stack.push({type:g.OPERATOR,value:t})}},{key:"maybeVisitMultisymbol",value:function(e){var i=this;if(""!==this.symbol){var n=this.tokens[e];n[3]&&(this.symbol+=n[3]);var c=t.UNARY_OPS.find((function(t){return i.symbol.startsWith(t)}));if(!c)return this.parseError("illegal unary operator"),!1;var a=this.symbol.substr(c.length);return this.symbol="",a&&a.length>0?this.visitIdentifier(a):this.visitToken(e+1),this.visitUnary(c),!0}return!1}},{key:"visitToken",value:function(t){if(!(t>=this.tokens.length)){var e=this.tokens[t],i=this.tokens[t-1],n=this.tokens[t+1];if(e[5]){if(")"===e[5])return void(this.skipTo=t+1);if("("!==e[5])return void this.parseError("malformed bracket expression");this.visitToken(t+1)}else{if(e[1]){var c=this.tokens[t+2];return n&&n[4]&&("+"===n[4]||"-"===n[4])&&c&&c[1]&&c[1].endsWith("i")?(this.visitNumber(e[1]+n[4]+c[1]),void this.visitToken(t+2)):(this.visitNumber(e[1]),void this.visitToken(t+1))}if(e[2]);else if(e[3])n&&n[3]?this.symbol+=e[3]:this.maybeVisitMultisymbol(t)||this.visitIdentifier(e[3]);else if(e[4])return"-"!==e[4]||!n||!(n[3]||n[5]||n[1])||i&&i[3]&&i[1]&&"("!==i[5]?i&&n?(this.visitToken(t+1),void this.visitBinary(e[4])):void this.parseError("incomplete binary operation"):(this.visitNumber("-1"),this.visitToken(t+1),void this.visitBinary("*"))}if(this.skipTo>0){if(this.tokens[this.skipTo]){var a=this.skipTo;return this.skipTo=-1,void this.visitToken(a)}}else this.visitToken(t+1)}}},{key:"visitMath",value:function(e){this.tokens=Object(s.a)(e.matchAll(t.TOKENIZER)),this.visitToken(0)}},{key:"visitFunctionDefinition",value:function(e){var i=e.match(t.FUNCTION_PATTERN);i&&4===i.length?(this.fxnName=i[1],this.fxnParam=i[2],this.visitMath(i[3])):this.parseError("malformed function definition")}}]),t}();function A(t,e,i){var n=t+"_"+e+i.map((function(t){return t.type+":"+t.value})).join("_");return"__jit_"+R()(n).toString().substr(0,16)}T.UNARY_OPS=["sinh","cosh","tanh","sech","csch","coth","sin","cos","tan","sec","csc","cot","arg"],T.FUNCTION_PATTERN=/^([a-zA-Z\\]+(?:_[a-zA-Z0-9,]+)?)\*? ?\(([a-zA-Z\\]+(?:_[a-zA-Z0-9,\\]+)?)\) ?= ?(.*)$/,T.TOKENIZER=/(-?\d+(?:\.\d+)?)(?:\*i)?|([a-zA-Z0-9]{2,} (?:_\([^)]+\)|_[a-zA-Z0-9])?)|([a-zA-Z](?:_\([^)]+\)|_[a-zA-Z0-9])?)|([+\-*/^])|([()])/g;var P=function(t){var e=Object(l.useState)(),i=Object(r.a)(e,2),n=(i[0],i[1]),c=Object(l.useRef)(null);return Object(l.useEffect)((function(){if(c.current){var e=S.MathField(c.current,Object(h.a)(Object(h.a)({},t.config),{},{handlers:{edit:function(e){var i,n,c=e.__controller.exportText(),a=new T;a.visitFunctionDefinition(c),a.parseErr&&t.onError?t.onError(a.parseErr):t.onSuccess&&a.fxnName&&a.fxnParam&&t.onSuccess(a.stack,a.fxnName,a.fxnParam,c),(null===(i=t.config)||void 0===i||null===(n=i.handlers)||void 0===n?void 0:n.edit)&&t.config.handlers.edit(e)}}}));e.el().classList.add("mq-restyler-field"),e.focus(),n(e)}}),[c,t.config]),Object(j.jsx)("div",{className:t.className,ref:c})},_={},U=function(t){var e=x(t.n,t.type),i=Object(r.a)(e,2),c=i[0],a=i[1],s=(Object(l.useRef)(null),Object(l.useRef)(null),Object(l.useState)(!1)),o=Object(r.a)(s,2),u=(o[0],o[1],Object(l.useState)(!1)),f=Object(r.a)(u,2),d=f[0],m=f[1],b=Object(l.useState)(null),O=Object(r.a)(b,2),p=O[0],v=O[1];return Object(l.useEffect)((function(){if(c.drawing&&(!c.jitFunction||c.jitFunction.getName()!==c.functionName)){if(_.hasOwnProperty(c.functionName))console.debug("cache hit for "+_[c.functionName]),a({jitFunction:_[c.functionName]});else{var e=new Module.MathCompilerDP(c.functionName,c.name,c.parameterName),i=e.compile(c.stack);a({jitFunction:i}),_[c.functionName]=i,e.delete()}t.drawCallback(t.n,!1),a({drawing:!1})}}),[c.drawing]),Object(j.jsxs)("div",{className:"function-entry-container",children:[Object(j.jsxs)("div",{className:"function-control-panel",children:[c.type===n.C2C?Object(j.jsx)(y.b,{minimal:!0,icon:0===c.style.opacity?"eye-off":"eye-open",onClick:function(t){0===c.style.opacity?a({style:Object(h.a)(Object(h.a)({},c.style),{},{opacity:.65})}):a({style:Object(h.a)(Object(h.a)({},c.style),{},{opacity:0})})},intent:0===c.style.opacity?k.a.WARNING:k.a.NONE}):Object(j.jsx)("button",{className:"function-color-button",style:{backgroundColor:c.style.stroke},onClick:function(t){var e="hsla(".concat(360*Math.random(),", 80%, 60%, 1)");a({style:{stroke:e}})}}),Object(j.jsx)(y.b,{id:"draw-function",minimal:!0,icon:"play",disabled:!c.stack||0===c.stack.length,loading:c.drawing,onClick:function(t){c.jitFunction&&c.jitFunction.getName()===c.functionName||a({drawing:!0})},intent:c.jitFunction?c.jitFunction.getName()===c.functionName?k.a.SUCCESS:k.a.WARNING:k.a.SUCCESS}),Object(j.jsx)(y.b,{minimal:!0,icon:"cog",disabled:!c.jitFunction,onClick:function(t){return m(!0)}})]}),Object(j.jsx)(P,{className:"function-input",onError:v,onSuccess:function(t,e,i,n){v(null),a({name:e,parameterName:i,text:n,stack:t,functionName:A(e,i,t)})}}),null===p?Object(j.jsx)(j.Fragment,{}):Object(j.jsx)("div",{className:"function-error",children:p}),Object(j.jsx)("div",{className:"function-delete-button-container",children:Object(j.jsx)(y.b,{minimal:!0,small:!0,icon:"small-cross",intent:k.a.DANGER,onClick:function(){t.drawCallback(c.id,!0),c.jitFunction&&c.jitFunction.release(),t.removeCallback()}})}),Object(j.jsx)(C,{isOpen:d,closeCallback:function(){return m(!1)},pfId:t.n})]})},D=function(t){return Object(j.jsxs)("div",{className:"new-function-button-container",children:[Object(j.jsx)(y.b,{id:"new-point",minimal:!0,icon:E,intent:k.a.SUCCESS,large:!0,onClick:function(){return t.addFunction(n.C)},disabled:!0}),Object(j.jsx)(y.b,{id:"new-arc",minimal:!0,icon:I,intent:k.a.SUCCESS,large:!0,onClick:function(){return t.addFunction(n.R2C)}}),Object(j.jsx)(y.b,{id:"new-fxn",minimal:!0,intent:k.a.SUCCESS,large:!0,onClick:function(){return t.addFunction(n.C2C)},children:Object(j.jsx)("b",{children:"\u2102"})})]})},z=(i(348),function(t){var e=Object(l.useState)(0),i=Object(r.a)(e,2),n=i[0],c=i[1],a=Object(l.useState)(new Map),o=Object(r.a)(a,2),u=o[0],f=o[1];return Object(j.jsxs)("div",{className:"left-sidebar",children:[Object(j.jsxs)("div",{style:{padding:"2px"},children:[Object(j.jsx)(y.a,{text:"Github",href:"https://github.com/glammath/glam",target:"_blank"}),Object(j.jsx)("span",{style:{paddingLeft:"25%",font:"14pt bold"},children:"Glam"})]}),u.size>0?Object(s.a)(u).map((function(e){return Object(j.jsx)(U,{n:e[0],removeCallback:function(){f((function(t){var i=new Map(t);return i.delete(e[0]),i}))},drawCallback:t.drawCallback,type:e[1]},e[0])})):Object(j.jsx)(j.Fragment,{}),Object(j.jsx)(D,{addFunction:function(t){f((function(e){var i=new Map(e);return i.set(n,t),i})),c((function(t){return t+1}))}})]})});i(349),i(350);function L(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(i){return Object(h.a)(Object(h.a)(Object(h.a)({signalName:t},i),e),{},{_dataType:function(t){}})}}L("Ready");var G=L("ArcFocus"),B=(L("TreeRecalculate"),function(t){var e=x(t.pfId),i=Object(r.a)(e,2),c=i[0],a=i[1];switch(c.type){case n.C:return Object(j.jsx)(j.Fragment,{});case n.R2C:return Object(j.jsx)(Z,Object(h.a)(Object(h.a)({},t),{},{pf:c,updatePf:a}));case n.C2C:return Object(j.jsx)(W,Object(h.a)(Object(h.a)({},t),{},{pf:c,updatePf:a}))}}),Z=function(t){var e,i=Object(l.useMemo)((function(){return new Module.RealMultipointDP(t.pf.jitFunction,t.limits[0],t.limits[2],t.res)}),[(null===(e=t.pf.jitFunction)||void 0===e?void 0:e.getName())||""]),n=Object(l.useContext)(m),c=Object(r.a)(n,2),a=(c[0],c[1]),s=Object(l.useMemo)((function(){if(i)return console.debug("evaluating multipoint"),i.fullEval(),new Float64Array(i.getValues())}),[i]);return Object(j.jsx)("polyline",{id:"plot-arc-".concat(t.pfId),className:"plot-arc",fill:"none",style:t.pf.style,points:null===s||void 0===s?void 0:s.join(","),onMouseOver:function(){a(G({arc:t.pfId}))},onMouseOut:function(){return a(G({arc:-1}))}})},W=function(t){var e=Object(l.useMemo)((function(){return new Module.ComplexMultipointDP(t.pf.jitFunction,[t.limits[0],t.limits[1]],[t.limits[2],t.limits[3]],t.res)}),[t.pf.jitFunction]),i=Object(l.useMemo)((function(){if(e){console.debug("evaluating multipoint"),e.fullEval();var t=e.getColors();return console.debug(t),t}}),[e]),n=Object(l.useMemo)((function(){if(i){var e=document.createElement("canvas"),n=e.getContext("2d");if(!n)return void console.error("could not get canvas context");var c=(t.limits[2]-t.limits[0])*t.res,a=(t.limits[3]-t.limits[1])*t.res;e.width=c,e.height=a,console.debug("plot: "+c+"x"+a);var s=new Uint8ClampedArray(i),r=new ImageData(s,c);return n.putImageData(r,0,0),e.toDataURL("image/png")}}),[i]);return Object(l.useEffect)((function(){t.updatePf({style:Object(h.a)(Object(h.a)({},t.pf.style),{},{opacity:.65})})}),[]),Object(j.jsx)("image",{id:"color-plot-".concat(t.pf.id),className:"color-plot",width:t.limits[2]-t.limits[1],height:t.limits[3]-t.limits[1],href:n,x:t.limits[0],y:t.limits[1],preserveAspectRatio:"xMidYMid meet",style:t.pf.style})},Y=function(t){var e=Object(l.useRef)(null),i=Object(l.useState)(0),n=Object(r.a)(i,2),c=(n[0],n[1]),a=Object(l.useState)([0,0]),s=Object(r.a)(a,2),o=(s[0],s[1]),u=Object(l.useState)([0,0]),f=Object(r.a)(u,2),d=(f[0],f[1]);return Object(l.useEffect)((function(){if(e.current){var i=[e.current.offsetWidth/2,e.current.offsetHeight/2],n=Math.min(e.current.offsetWidth/(t.limits[1]-t.limits[0]),e.current.offsetHeight/(t.limits[3]-t.limits[2]));d([Math.ceil(e.current.offsetWidth/n),Math.ceil(e.current.offsetHeight/n)]);var a=[i[0],i[1]];c(n),o(a)}}),[t]),Object(j.jsx)("div",{ref:e,className:"plot-grid-container",children:Object(j.jsx)("svg",{className:"plot-space",width:"100%",height:"100%",viewBox:"".concat(t.limits[0]," ").concat(t.limits[1]," ").concat(t.limits[2]-t.limits[0]," ").concat(t.limits[3]-t.limits[1]),preserveAspectRatio:"xMidYMid slice",children:Object(j.jsxs)("g",{className:"coordinate-y-flip",children:[Object(j.jsx)(H,{limits:t.limits,majorInterval:t.majorTicks,minorTicksPerMajor:t.minorTicks,hideMinorGrid:!1}),t.drawList.map((function(e){return Object(j.jsx)(B,{pfId:e,limits:[t.limits[0],t.limits[1],t.limits[2],t.limits[3]],res:50},e)}))]})})})},H=function(t){var e=t.majorInterval/t.minorTicksPerMajor;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("defs",{children:[Object(j.jsx)("pattern",{id:"grid-lines-minor",width:e,height:e,patternUnits:"userSpaceOnUse",children:Object(j.jsx)("path",{className:"plot-grid-minor-line",d:"M ".concat(e," 0 L 0 0 0 ").concat(e)})}),Object(j.jsxs)("pattern",{id:"grid-lines-major",width:t.majorInterval,height:t.majorInterval,patternUnits:"userSpaceOnUse",children:[t.hideMinorGrid?Object(j.jsx)(j.Fragment,{}):Object(j.jsx)("rect",{width:t.majorInterval,height:t.majorInterval,fill:"url(#grid-lines-minor)"}),Object(j.jsx)("path",{className:"plot-grid-major-line",d:"M ".concat(t.majorInterval," 0 L 0 0 0 ").concat(t.majorInterval)})]})]}),Object(j.jsx)("rect",{x:t.limits[0],y:t.limits[1],width:"100%",height:"100%",fill:"url(#grid-lines-major)"}),Object(j.jsx)("line",{className:"plot-grid-axis-line",x1:t.limits[0],y1:"0",x2:t.limits[2],y2:"0"}),Object(j.jsx)("line",{className:"plot-grid-axis-line",x1:"0",y1:t.limits[1],x2:"0",y2:t.limits[3]}),Object(s.a)(Array(Math.ceil(t.limits[2]/t.majorInterval)).keys()).map((function(t){return t+1})).map((function(t){return Object(j.jsx)("text",{className:"plot-grid-major-label",x:t,y:"0",fontSize:"0.1",children:t},t+",0")})),Object(s.a)(Array(Math.ceil(Math.abs(t.limits[0]/t.majorInterval))).keys()).map((function(t){return t+1})).map((function(t){return Object(j.jsxs)("text",{className:"plot-grid-major-label",x:-t,y:"0",fontSize:"0.1",children:["-",t]},"-"+t+",0")})),Object(s.a)(Array(Math.ceil(t.limits[3]/t.majorInterval)).keys()).map((function(t){return t+1})).map((function(t){return Object(j.jsxs)("text",{className:"plot-grid-major-label",x:"0",y:t,fontSize:"0.1",children:["-",t,"i"]},"0,"+t)})),Object(s.a)(Array(Math.ceil(Math.abs(t.limits[1]/t.majorInterval))).keys()).map((function(t){return t+1})).map((function(t){return Object(j.jsxs)("text",{className:"plot-grid-major-label",x:"0",y:-t,fontSize:"0.1",children:[t,"i"]},"0,-"+t)}))]})},J=function(t){var e=Object(l.useState)([]),i=Object(r.a)(e,2),n=i[0],c=i[1],a=Object(l.useCallback)((function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e?c(n.filter((function(e){return e!==t}))):n.includes(t)||c([].concat(Object(s.a)(n),[t]))}),[n,c]);return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(b,{children:Object(j.jsxs)(v,{children:[Object(j.jsx)(z,{drawCallback:a}),Object(j.jsx)(Y,{majorTicks:1,minorTicks:5,limits:[-4,-4,4,4],drawList:n})]})})})};window.addEventListener("nativeInit",(function(){a.a.render(Object(j.jsx)(J,{}),document.querySelector(".glam-app-container"))}))}},[[351,1,2]]]);
//# sourceMappingURL=main.c2a309e9.chunk.js.map